<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>从省二到全国第五后，我们决定开源</title>
    <link href="/2025/08/22/%E4%BB%8E%E7%9C%81%E4%BA%8C%E5%88%B0%E5%85%A8%E5%9B%BD%E7%AC%AC%E4%BA%94%E5%90%8E%EF%BC%8C%E6%88%91%E4%BB%AC%E5%86%B3%E5%AE%9A%E5%BC%80%E6%BA%90/"/>
    <url>/2025/08/22/%E4%BB%8E%E7%9C%81%E4%BA%8C%E5%88%B0%E5%85%A8%E5%9B%BD%E7%AC%AC%E4%BA%94%E5%90%8E%EF%BC%8C%E6%88%91%E4%BB%AC%E5%86%B3%E5%AE%9A%E5%BC%80%E6%BA%90/</url>
    
    <content type="html"><![CDATA[<h1 id="从省二到全国第五后，我们决定开源"><a href="#从省二到全国第五后，我们决定开源" class="headerlink" title="从省二到全国第五后，我们决定开源"></a><center>从省二到全国第五后，我们决定开源</center></h1><p><font size=4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;大家好，我们是完全模型组&nbsp;<strong>南京信息工程大学</strong>&nbsp;&nbsp;<strong>RunACCM2025</strong>队，在此想讲一讲自己从十九届到二十届的参赛经历。<br> <div align=center><img src="/img/SCC/20届合影.png" width = "640" height = "480" alt="20届合影"></div><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;大一刚开学，便从学院宣传活动中了解到了学校的智能车实验室，经过重重考核加入了我们学校的完全模型组队伍，和两位学长一起备战十九届智能车。那时候才大一，仍抱有学长带飞心理，因此在组内摸鱼，没干什么实事，最后遗憾止步省二。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;去年十二月，我和三位大一学弟开始着手备战第二十届智能车完全模型组，我们重构了巡线代码。今年2月，硬件学弟焊接测试好板子，车子正式复活，用重构后的代码第一次下地跑，我的心里非常激动，总算是开了个好头！但是我很快发现，采用sasu开源的控制方案上限低，一旦提速就容易冲出赛道，于是我开始了解其他的控制方式。在学习过程中，我了解到了纯跟踪算法，通过几何学计算误差，并通过PD控制舵机打角。很快这套算法就落地了，看着比去年还快的小车，心中有了冲国一的想法。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可现实却给我当头一棒，四五月份，我们组一连走了两位学弟，只剩下我和硬件学弟苦苦支撑，但好在我们的老学长答应重新出山，并且新招到了一位可靠的好学弟，于是我们四人重振旗鼓，开始征战。很快我们组渐渐发现，限制这辆车速度的不是软件，而是结构。sasu的I车模与传统车模不同，它就像一辆真车，避震、差速器、重心高低、轮胎角度等任何一个因素都会对车子造成极大的影响。于是我们开始漫长的结构调试阶段，从上到下每一个组合全部尝试了一遍，最终在省赛前夕选出了一套最适合当前车模的配置，基本不会在有转向过度和转向不足的情况，此外我们还设计了一款帅气的车壳。最终我们在华东区赛大放异彩，获得了区赛第三名的好成绩。<br> <div align=center><img src="/img/SCC/车壳.png" width = "640" height = "480" alt="车壳"></div><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;经过区赛，我们认识到了自己和国一之间的差距，于是开始加班加点调优软件，累了就在赛道边小憩一会儿，那段时间我和学弟已经不分昼夜，都在为了国一努力。学长也很给力，连续给我们训练了好几版准确率高的模型，全队四人上下同心，都在为了国一而奋斗。很快，国赛到来了，我和两个学弟带着车模前往杭州，第一天预赛全国第六，第二天决赛全国第五，拿下了国一的好成绩。<br>  <div align=center><img src="/img/SCC/颁奖.JPG"  alt="颁奖"></div><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;比赛结束后，我和学弟商量了一下，虽然完全模型组已经创办五年，但还是存在开源资料少、新手入门难的问题，于是我们决定开源所有的上位机代码，让更多的人感受完全模型的乐趣,正如卓晴教授所说: <strong>这里没有藏私的大神，只有开源的胜利。</strong></p><p>开源链接:<a href="https://github.com/hccc1203/RunACCM2025">https://github.com/hccc1203/RunACCM2025</a></p><p>决赛视频:<a href="https://www.bilibili.com/video/BV1rqegzqEai/?vd_source=2a8cbc7573c206fb85016209aa7afaae#reply115060580093170">https://www.bilibili.com/video/BV1rqegzqEai/?vd_source=2a8cbc7573c206fb85016209aa7afaae#reply115060580093170</a></p><p> <strong>Author 南京信息工程大学 RunACCM2025 胡城玮 熊金钰 孙酩贺 周杨</strong></p><h2 id="特别鸣谢"><a href="#特别鸣谢" class="headerlink" title="特别鸣谢"></a>特别鸣谢</h2><p><font size=3><strong>长安大学 没有霹雳猫猫队<br> 天津大学      天有四时队<br> 上海海事大学  赤霄驭风队<br> 华南理工大学  华工龙泉队<br> 上海电机学院  孤注一航队<br> 江苏理工学院  凌波·夜幕队<br> 大连民族大学  大佬说的队<br> 长安大学十九届开源链接 <a href="https://gitee.com/JYSimilar/icar_2024">https://gitee.com/JYSimilar/icar_2024</a></strong></font></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>电赛K230使用记录</title>
    <link href="/2025/08/04/25%E7%94%B5%E8%B5%9BK230%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/"/>
    <url>/2025/08/04/25%E7%94%B5%E8%B5%9BK230%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="关于K230ai模型使用记录"><a href="#关于K230ai模型使用记录" class="headerlink" title="关于K230ai模型使用记录"></a>关于K230ai模型使用记录</h1><h3 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作者前两天参加了25电赛，使用了<strong>嘉立创庐山派</strong>的K230。在AI识别方面遇到了一些问题，特此写一下这篇blog，记录一下。通过采集数据集、打框、训练后，导出后，官方给了我这么一段示例代码。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os, gc<br><span class="hljs-keyword">from</span> libs.PlatTasks <span class="hljs-keyword">import</span> DetectionApp<br><span class="hljs-keyword">from</span> libs.PipeLine <span class="hljs-keyword">import</span> PipeLine<br><span class="hljs-keyword">from</span> libs.Utils <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># Set display mode: options are &#x27;hdmi&#x27;, &#x27;lcd&#x27;, &#x27;lt9611&#x27;, &#x27;st7701&#x27;, &#x27;hx8399&#x27;</span><br><span class="hljs-comment"># &#x27;hdmi&#x27; defaults to &#x27;lt9611&#x27; (1920x1080); &#x27;lcd&#x27; defaults to &#x27;st7701&#x27; (800x480)</span><br>display_mode = <span class="hljs-string">&quot;lt9611&quot;</span><br><span class="hljs-comment"># Define the input size for the RGB888P video frames</span><br>rgb888p_size = [<span class="hljs-number">640</span>, <span class="hljs-number">480</span>]<br><span class="hljs-comment"># Set root directory path for model and config</span><br>root_path = <span class="hljs-string">&quot;/sdcard/mp_deployment_source/&quot;</span><br><span class="hljs-comment"># Load deployment configuration</span><br>deploy_conf = read_json(root_path + <span class="hljs-string">&quot;/deploy_config.json&quot;</span>)<br>kmodel_path = root_path + deploy_conf[<span class="hljs-string">&quot;kmodel_path&quot;</span>]              <span class="hljs-comment"># KModel path</span><br>labels = deploy_conf[<span class="hljs-string">&quot;categories&quot;</span>]                                <span class="hljs-comment"># Label list</span><br>confidence_threshold = deploy_conf[<span class="hljs-string">&quot;confidence_threshold&quot;</span>]        <span class="hljs-comment"># Confidence threshold</span><br>nms_threshold = deploy_conf[<span class="hljs-string">&quot;nms_threshold&quot;</span>]                      <span class="hljs-comment"># NMS threshold</span><br>model_input_size = deploy_conf[<span class="hljs-string">&quot;img_size&quot;</span>]                        <span class="hljs-comment"># Model input size</span><br>nms_option = deploy_conf[<span class="hljs-string">&quot;nms_option&quot;</span>]                            <span class="hljs-comment"># NMS strategy</span><br>model_type = deploy_conf[<span class="hljs-string">&quot;model_type&quot;</span>]                            <span class="hljs-comment"># Detection model type</span><br>anchors = []<br><span class="hljs-keyword">if</span> model_type == <span class="hljs-string">&quot;AnchorBaseDet&quot;</span>:<br>    anchors = deploy_conf[<span class="hljs-string">&quot;anchors&quot;</span>][<span class="hljs-number">0</span>] + deploy_conf[<span class="hljs-string">&quot;anchors&quot;</span>][<span class="hljs-number">1</span>] + deploy_conf[<span class="hljs-string">&quot;anchors&quot;</span>][<span class="hljs-number">2</span>]<br><span class="hljs-comment"># Inference configuration</span><br>inference_mode = <span class="hljs-string">&quot;video&quot;</span>                                          <span class="hljs-comment"># Inference mode: &#x27;video&#x27;</span><br>debug_mode = <span class="hljs-number">0</span>                                                    <span class="hljs-comment"># Debug mode flag</span><br><span class="hljs-comment"># Create and initialize the video/display pipeline</span><br>pl = PipeLine(rgb888p_size=rgb888p_size, display_mode=display_mode)<br>pl.create()<br>display_size = pl.get_display_size()<br><span class="hljs-comment"># Initialize object detection application</span><br>det_app = DetectionApp(inference_mode,kmodel_path,labels,model_input_size,anchors,model_type,confidence_threshold,nms_threshold,rgb888p_size,display_size,debug_mode=debug_mode)<br><span class="hljs-comment"># Configure preprocessing for the model</span><br>det_app.config_preprocess()<br><span class="hljs-comment"># Main loop: capture, run inference, display results</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">with</span> ScopedTiming(<span class="hljs-string">&quot;total&quot;</span>, <span class="hljs-number">1</span>):<br>        img = pl.get_frame()                          <span class="hljs-comment"># Capture current frame</span><br>        res = det_app.run(img)                        <span class="hljs-comment"># Run inference</span><br>        det_app.draw_result(pl.osd_img, res)          <span class="hljs-comment"># Draw detection results</span><br><br>        pl.show_image()                               <span class="hljs-comment"># Show result on display</span><br>        gc.collect()                                  <span class="hljs-comment"># Run garbage collection</span><br><span class="hljs-comment"># Cleanup: These lines will only run if the loop is interrupted (e.g., by an IDE break or external interruption)</span><br>det_app.deinit()                                      <span class="hljs-comment"># De-initialize detection app</span><br>pl.destroy()                                          <span class="hljs-comment"># Destroy pipeline instance</span><br></code></pre></td></tr></table></figure><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;由代码可见，它新建了一个<strong>管道</strong>来采集摄像头的数据。但是当时作者已经使用了Sensor模块采集数据，两者不能同时存在。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;下面是作者原本使用的初始化方式。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">sensor = Sensor() <br>sensor.reset() <br>sensor.set_framesize(width = <span class="hljs-number">640</span>,height = <span class="hljs-number">480</span>) <br>sensor.set_pixformat(Sensor.RGB565) <br>sensor.run() <br></code></pre></td></tr></table></figure><h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作者通过<a href="https://wiki.lckfb.com/zh-hans/lushan-pi-k230/api/mpp/k230_canmv_sensor_module_api.html">庐山派官方资料</a>查询得知：<strong>每个图像处理单元最多支持三个输出通道。</strong><img src="/img/K230Sensor.jpg">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;于是作者就在想是否可以通过一个摄像头，输出给两个通道，一个喂给AI识别，另一个给矩形检测。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">init_sensor</span>():<br>    sensor = Sensor(<span class="hljs-built_in">id</span> = <span class="hljs-number">2</span>)<br>    sensor.reset()<br>    sensor.set_framesize(width=DISPLAY_WIDTH, height=DISPLAY_HEIGHT,chn=CAM_CHN_ID_0)<br>    sensor.set_pixformat(sensor.GRAYSCALE,chn=CAM_CHN_ID_0)<br>    sensor.set_framesize(width = WIDTH, height = HEIGHT,chn=CAM_CHN_ID_1)<br>    sensor.set_pixformat(Sensor.RGBP888, chn=CAM_CHN_ID_1)<br>    <span class="hljs-keyword">return</span> sensor<br><br><span class="hljs-comment"># 中间部分省略...</span><br><span class="hljs-comment">#使用部分</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    clock.tick()<br>    os.exitpoint()<br>    <span class="hljs-comment"># 捕获图像 / Capture image</span><br>    img = sensor.snapshot(chn=CAM_CHN_ID_0)<br>    img.draw_cross(<span class="hljs-number">320</span>,<span class="hljs-number">240</span>)<br>    error_effect_flag = <span class="hljs-literal">False</span><br><br>    img_ai = sensor.snapshot(chn=CAM_CHN_ID_1)<br>    img_ai=img_ai.to_numpy_ref()<br></code></pre></td></tr></table></figure><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;使用此方法即可通过sensor实现AI和矩形识别同时处理。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=3>此视觉方案已开源，开源地址:<a href="https://wiki.lckfb.com/zh-hans/lushan-pi-k230/api/mpp/k230_canmv_sensor_module_api.html">https://github.com/hccc1203/25diansaiE</a></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;示例视频地址:<a href="https://www.bilibili.com/video/BV1Y1hMzkELb/?spm_id_from=333.1387.homepage.video_card.click&vd_source=2a8cbc7573c206fb85016209aa7afaae">https://www.bilibili.com/video/BV1Y1hMzkELb/?spm_id_from&#x3D;333.1387.homepage.video_card.click&amp;vd_source&#x3D;2a8cbc7573c206fb85016209aa7afaae</a></p><!-- 单页面访问量（放在文章模板中） --><p align="right"><font size=2>本页总阅读量 <span id="busuanzi_page_pv">加载中...</span> 次</font></p><p align="right"><font size=2>本页总访客数 <span id="busuanzi_page_uv">加载中...</span> 人</font></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
